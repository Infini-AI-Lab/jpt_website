<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jackpot: Optimal Budgeted Rejection Sampling for Extreme Actor-Policy Mismatch Reinforcement Learning</title> 
  <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><rect x='6.8' y='6.8' width='27' height='34' rx='4.2' transform='rotate(-12 20.3 23.8)' fill='rgb(244,196,121)' fill-opacity='0.65' stroke='rgb(255,255,255)' stroke-opacity='0.72'/><rect x='13.5' y='8.8' width='27' height='34' rx='4.2' transform='rotate(8 27 25.8)' fill='rgb(255,255,255)' fill-opacity='0.92' stroke='rgb(255,255,255)' stroke-opacity='0.96'/><text x='19.8' y='16.7' font-size='5.2' font-weight='700' font-family='Georgia, Times New Roman, serif' fill='rgb(10,10,10)'>A</text><path d='M27.8 20.1c1.4-2.2 4-2.3 4.9-.6.6 1.2.2 2.5-1.4 3.8-1.3 1-2.7 2.2-3.5 3.4-.8-1.2-2.1-2.4-3.4-3.4-1.7-1.3-2.1-2.6-1.4-3.8.9-1.7 3.4-1.6 4.8.6z' fill='rgb(10,10,10)'/><path d='M27.8 26.7l1.8 4.5h-3.6z' fill='rgb(10,10,10)'/></svg>">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    :root {
      --bg: #f4f1ea;
      --ink: #11131a;
      --muted: #525867;
      --line: rgba(17, 19, 26, 0.12);
      --card: #ffffff;
      --accent: #d14572;
      --accent-2: #0f6f5c;
      --hero: linear-gradient(140deg, #161824, #2a2132 52%, #17302a);
      --shadow: 0 16px 36px rgba(18, 20, 31, 0.1);
    }

    * { box-sizing: border-box; }

    html { scroll-behavior: smooth; }

    body {
      margin: 0;
      color: var(--ink);
      background:
        radial-gradient(900px 520px at 0% -10%, rgba(209, 69, 114, 0.18), transparent 55%),
        radial-gradient(760px 500px at 100% 0%, rgba(15, 111, 92, 0.16), transparent 56%),
        var(--bg);
      font-family: "Iowan Old Style", "Palatino Linotype", "Book Antiqua", Palatino, serif;
      line-height: 1.62;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .wrap {
      max-width: 1120px;
      margin: 0 auto;
      padding: 28px 20px 72px;
    }

    .hero {
      position: relative;
      border-radius: 24px;
      padding: 36px;
      color: #f7f4f0;
      background: var(--hero);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .hero::after {
      content: "";
      position: absolute;
      width: 260px;
      height: 260px;
      top: -90px;
      right: -50px;
      background: radial-gradient(circle, rgba(209, 69, 114, 0.62), transparent 65%);
      pointer-events: none;
      opacity: 0.75;
    }

    .hero-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 22px;
      align-items: center;
      position: relative;
      z-index: 1;
    }

    .logo {
      width: 120px;
      height: 120px;
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(255, 255, 255, 0.08);
      padding: 10px;
      object-fit: contain;
    }

    h1 {
      margin: 0 0 8px;
      font-family: "Avenir Next", "Gill Sans", "Trebuchet MS", sans-serif;
      font-size: clamp(1.75rem, 2.9vw, 2.8rem);
      letter-spacing: -0.02em;
      line-height: 1.18;
    }

    .title-row {
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }

    .title-icon {
      width: 1.15em;
      height: 1.15em;
      margin-top: 0.16em;
      flex: 0 0 auto;
    }

    .title-icon .card-back {
      fill: rgba(244, 196, 121, 0.65);
      stroke: rgba(255, 255, 255, 0.72);
    }

    .title-icon .card-front {
      fill: rgba(255, 255, 255, 0.92);
      stroke: rgba(255, 255, 255, 0.96);
    }

    .title-icon .ace-mark,
    .title-icon .ace-index {
      fill: rgba(10, 10, 10, 0.96);
    }

    .authors,
    .inst,
    .hero-note {
      margin: 0;
      color: rgba(247, 244, 240, 0.84);
    }

    .authors {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin-top: 4px;
    }

    .author-btn {
      display: inline-flex;
      align-items: center;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 0.86rem;
      border: 1px solid rgba(255, 255, 255, 0.28);
      background: rgba(255, 255, 255, 0.08);
      color: rgba(247, 244, 240, 0.94);
    }

    .author-btn:hover { background: rgba(255, 255, 255, 0.16); }

    .inst { margin-top: 2px; }

    .hero-note {
      margin-top: 12px;
      max-width: 840px;
    }

    .hero-actions {
      display: flex;
      justify-content: center;
      gap: 36px;
      flex-wrap: wrap;
      margin-top: 16px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      border-radius: 999px;
      font-family: "Avenir Next", "Gill Sans", "Trebuchet MS", sans-serif;
      font-size: 0.9rem;
      border: 1px solid rgba(255, 255, 255, 0.26);
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
    }

    .btn:hover { background: rgba(255, 255, 255, 0.18); }

    .external-link.button.is-dark {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      border-radius: 999px;
      font-family: "Avenir Next", "Gill Sans", "Trebuchet MS", sans-serif;
      font-size: 0.9rem;
      background: #161824;
      border: 1px solid rgba(255, 255, 255, 0.22);
      color: #f7f4f0;
      text-decoration: none;
    }

    .external-link.button.is-dark:hover {
      background: #1e2333;
    }

    nav {
      margin: 0 0 16px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      position: sticky;
      top: 12px;
      z-index: 10;
      background: rgba(252, 251, 248, 0.92);
      padding: 8px 10px;
      border-radius: 12px;
      backdrop-filter: blur(6px);
    }

    .chip {
      border: 1px solid var(--line);
      border-radius: 999px;
      padding: 7px 12px;
      font-size: 0.86rem;
      background: rgba(255, 255, 255, 0.74);
      color: var(--muted);
      font-family: "Avenir Next", "Gill Sans", "Trebuchet MS", sans-serif;
    }

    section {
      margin-top: 42px;
      padding: 20px 22px;
      border-radius: 14px;
      background: #fcfbf8;
      border: 1px solid rgba(43, 29, 17, 0.08);
    }

    .wrap > section:nth-of-type(even) {
      background: #ffffff;
    }

    h2 {
      margin: 0 0 12px;
      font-family: "Avenir Next", "Gill Sans", "Trebuchet MS", sans-serif;
      font-size: 1.45rem;
      letter-spacing: -0.01em;
    }

    h3 {
      margin: 0 0 8px;
      font-family: "Avenir Next", "Gill Sans", "Trebuchet MS", sans-serif;
      font-size: 1.06rem;
      letter-spacing: -0.01em;
    }

    p { margin: 0; }
    pre, code {
      white-space: pre-wrap;
      word-break: break-word;
    }
    pre code {
      display: block;
      background: #f3f5fb;
      border: 1px solid rgba(43, 29, 17, 0.12);
      border-radius: 10px;
      padding: 12px 14px;
      color: #1f2430;
    }

    .lede {
      font-size: 1.03rem;
      color: var(--muted);
      max-width: 940px;
    }

    .grid {
      display: grid;
      gap: 16px;
    }

    .grid-2 { grid-template-columns: repeat(auto-fit, minmax(270px, 1fr)); }
    .grid-3 { grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); }

    .card {
      border: 1px solid var(--line);
      background: var(--card);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 8px 20px rgba(16, 18, 30, 0.05);
    }

    .card p { color: var(--muted); }

    .list {
      margin: 0;
      padding-left: 18px;
      color: var(--muted);
    }

    .list li + li { margin-top: 8px; }

    .formula {
      margin-top: 10px;
      font-family: "Menlo", "Consolas", "SFMono-Regular", monospace;
      font-size: 0.9rem;
      background: #f8f7f3;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px 12px;
      overflow-x: auto;
      color: #222937;
    }

    .link-frame {
      display: inline-flex;
      padding: 6px;
      border: 2px solid #1e4f9a;
      border-radius: 999px;
      background: rgba(217, 236, 255, 0.5);
      align-items: center;
    }

    .fig-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
    }

    figure {
      margin: 0;
      background: #fcfbf8;
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 12px;
    }

    figure img {
      display: block;
      width: 100%;
      height: auto;
      border-radius: 10px;
    }

    figcaption {
      margin-top: 8px;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .small {
      font-size: 0.92rem;
      color: var(--muted);
    }

    .footer {
      margin-top: 48px;
      border-top: 1px solid var(--line);
      padding-top: 16px;
      color: var(--muted);
      font-size: 0.92rem;
    }

    @media (max-width: 700px) {
      .hero { padding: 28px 20px; }
      .hero-grid { grid-template-columns: 1fr; }
      .logo { width: 88px; height: 88px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <nav>
      <a class="chip" href="#introduction">Introduction</a>
      <a class="chip" href="#problem">OBRS</a>
      <a class="chip" href="#method">Numerical Simulation</a>
      <a class="chip" href="#theory">Jackpot</a>
      <a class="chip" href="#experiments">Experiments</a>
      <a class="chip" href="#limitations">Limitations</a>
      <a class="chip" href="#citeus">Cite Us</a> 
    </nav>

    <header class="hero" id="top">
      <div class="hero-grid">
        <div>
          <h1 class="title-row">
            <svg class="title-icon" viewBox="0 0 48 48" aria-hidden="true" focusable="false">
              <rect class="card-back" x="6.8" y="6.8" width="27" height="34" rx="4.2" transform="rotate(-12 20.3 23.8)" />
              <rect class="card-front" x="13.5" y="8.8" width="27" height="34" rx="4.2" transform="rotate(8 27 25.8)" />
              <text class="ace-index" x="19.8" y="16.7" font-size="5.2" font-weight="700" font-family="Georgia, 'Times New Roman', serif">A</text>
              <path class="ace-mark" d="M27.8 20.1c1.4-2.2 4-2.3 4.9-.6.6 1.2.2 2.5-1.4 3.8-1.3 1-2.7 2.2-3.5 3.4-.8-1.2-2.1-2.4-3.4-3.4-1.7-1.3-2.1-2.6-1.4-3.8.9-1.7 3.4-1.6 4.8.6z" />
              <path class="ace-mark" d="M27.8 26.7l1.8 4.5h-3.6z" />
            </svg>
            <span>Jackpot: Optimal Budgeted Rejection Sampling for Extreme Actor-Policy Mismatch Reinforcement Learning</span>
          </h1>
          <p class="authors">
            <a class="author-btn" href="#">Zhuoming Chen*</a>
            <a class="author-btn" href="#">Hongyi Liu*</a>
            <a class="author-btn" href="#">Yang Zhou*</a>
            <a class="author-btn" href="#">Haizhong Zheng</a>
            <a class="author-btn" href="#">Beidi Chen</a>
          </p>
          <p class="inst">Carnegie Mellon University, * for equal contribution</p> 
          <div class="hero-actions">
            <!-- <a class="btn" href="#">arxiv link</a>  --> 
            <!-- <a class="btn" href="#">code</a>  --> 
            <span class="link-frame">
              <a href="https://arxiv.org/abs/2502.05252" target="_blank"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                  <i class="ai ai-arxiv"></i>
                </span>
                <span>arXiv</span>
              </a>
            </span>
            <span class="link-frame">
              <a href="https://github.com/Infini-AI-Lab/jackpot" target="_blank"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                  <i class="fab fa-github"></i>
                </span>
                <span>Code</span> 
              </a>
            </span>
          </div>
        </div>
      </div>
    </header>

    <section id="introduction">
      <h2>Introduction</h2>
      <p class="lede" style="max-width: none; width: 100%;">
        Reinforcement learning for LLMs is expensive, with rollout generation often dominating runtime by 80% <a href="https://arxiv.org/abs/2511.14617" target="_blank" rel="noopener noreferrer" style="color: #7a3db8;">[Seer]</a>. 
        <!-- Jackpot introduces Optimal Budgeted Rejection Sampling (OBRS) to reduce mismatch between a cheap rollout model and an evolving policy model under a controllable acceptance budget.  --> 
        On top of the prior works exploring ways to lower the rollout costs, Jackpot pushes the scenario of actor-policy mismatch to the extreme and ask the following question: 
        <br>
        <span style="font-weight: bold; color: #123b7a; background: #d9ecff; padding: 6px 10px; border-radius: 6px; border: 2px solid #1e4f9a; display: block; text-align: center; width: 100%; box-sizing: border-box;">Is it possible to perform rollouts using a completely different model from the one we utimately want to train?</span> 
        <br> 
        The potential efficiency benefit of completely decoupling the rollout and policy is obvious, and the smaller variant in the same model family can usually achieve non-zero rewards on challenging datasets. 
        However, different from the past actor-policy mismatch scenarios (Large staleness, KV quantization, etc.), the KL divergence between the actor and policy between two different models is <span style="font-weight: bold; color: #7a3db8;"></span>orders of magnitude larger</span>. 
        To attain our goal, we propose Jackpot that utilizes <span style="font-weight: bold; color: #7a3db8;">Optimal Budgeted Rejection Sampling (OBRS)</span> to actively modify the rollout distribution and rollout to reduce the distribution mismatch. 
        We show that Jackpot can reduce KL divergence with <span style="font-weight: bold; color: #7a3db8;">provable guarantees</span> and empirically achieve <span style="font-weight: bold; color: #7a3db8;">significant stability improvements</span> on challenging Qwen3-1.7B-Base rollout and Qwen3-8B-Base update settings (up to 300 steps of stable training on <a href="https://arxiv.org/abs/2511.14617" target="_blank" rel="noopener noreferrer" style="color: #7a3db8;">DeepScaleR</a> dataaset). 
      </p> 
      <div style="height: 16px;"></div>
      <figure>
        <div style="display: inline-block; border-radius: 10px; border: 1px dashed #b9c2d3; background: linear-gradient(135deg, #f7f9fc 0%, #eef2f8 100%); padding: 8px;">
          <img src="assets/figures/generalbigpicturer.png" alt="General Description of actor-policy mismatch and Jackpot Performance" style="display: block; width: auto; height: auto; max-width: 100%; border-radius: 8px;" />
        </div>
      </figure>
      <figcaption>Left: General Description of the actor-policy mismatch scenario. Jackpot is generally applicable. Right: Illustration of Jackpot performance on the two model joint training scenario, achieving significantly more stable training than TIS. </figcaption> 
    </section> 

    <section id="problem">
      <h2>Optimal Budgeted Rejection Sampling (OBRS)</h2>
      <div class="grid grid-2">
        <div class="lede" style="max-width: none; width: 100%;">
          <script>
            window.MathJax = {
              tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
              },
              chtml: { scale: 1.0 }
            };
          </script>
          <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
          <section class="paper">
            <p class="lead">
              <strong>Prior Distribution Mismatch Correction in RL</strong>
              can be generally formulated as, an Actor (i.e., the rollout model) and a policy (i.e., the trained model) mismatch is a common problem that has
              long been studied, e.g., <span class="cite">(Espeholt et al., 2018)</span>. To alleviate the actor–policy
              distribution gap, prior methods leverage importance sampling to approximate the true PPO objective.
            </p>
          
            <div class="eq-wrap">
              \[
              \mathcal{L}^{\text{PPO}}(\theta)
              = \mathbb{E}_{x \sim p_{\text{inf}}}\Big[
                \text{SG}\!\Big(
                  \underbrace{\boldsymbol{F}\!\Big(\tfrac{p_{\text{ref}}(x)}{p_{\text{inf}}(x)}\Big)}_{\text{adjustment}}
                \Big)
                \min\Big(
                  r_\theta(x)\,\hat{A}(x),
                  \operatorname{clip}\!\big(r_\theta(x), 1-\epsilon, 1+\epsilon\big)\,\hat{A}(x)
                \Big)
              \Big].
              \]
              <div class="eq-highlight" aria-hidden="true"></div>
            </div>
          
            <p>
              \( \text{SG} \) means stop gradients. The choice of adjustment function \( \boldsymbol{F} \) is one of the
              core focuses of prior work. Areal uses \( \boldsymbol{F}(x)=x \); Flash-RL and Llama-RL use
              \( \boldsymbol{F}(x)=\min(x,C) \) (i.e., truncated importance sampling, TIS), where \( C \) is a
              hyper-parameter; IceProp uses a bi-directional truncation:
            </p>
          
            <div class="eq-wrap">
              \[
              \boldsymbol{F}(x)=
              \begin{cases}
                x, & \text{if } x \in [\alpha,\beta],\\[6pt]
                0, & \text{otherwise}.
              \end{cases}
              \]
            </div>
          
            <p>
              From a systems perspective, FP32 LM heads and deterministic LLM inference are implemented to mitigate
              numerical issues in serving systems during rollout.
            </p>
          </section>
          
          <style>
            .paper{
              max-width: none;
              width: 100%;
              margin: 0;
              font-size: 16px;
              line-height: 1.65;
            }
            .paper .lead{ margin: 0 0 10px; }
            .cite{ color:#666; }
          
            /* Key: prevent “cut off” */
            .eq-wrap{
              position: relative;
              margin: 8px 0 12px;
              padding: 0;
              background: transparent;
              border-left: none;
              overflow-x: auto;              /* scroll instead of cut */
              -webkit-overflow-scrolling: touch;
            }
          
            /* Optional: mimic your lightpink highlight, but safely (CSS, not LaTeX colorbox) */
            .eq-highlight{
              /* This is a subtle highlight overlay; tune or delete if you don't want it */
              position: absolute;
              left: 22px;
              top: 18px;
              width: 280px;
              height: 32px;
              background: rgba(255, 182, 193, 0.35); /* lightpink */
              border-radius: 6px;
              pointer-events: none;
              mix-blend-mode: multiply;
              /* If you want it EXACTLY behind F(...), you'll need to manually tweak size/position */
              display: none; /* turn on if you want: set to block */
            }
          </style> 
          <strong>However, Importance Sampling based methods are vulnerable to extreme actor-policy mismatch.</strong>
          Once the actor drifts too far, many tokens that the actor samples with high probability have very low probability under the policy, since \( p_{\text{inf}} > p_{\text{target}} \). 
          These actor trajectories are effectively treated as low-likelihood samples by the policy, causing TIS to train on tokens the policy would never select at inference and creating a widening train-inference mismatch. 
          <span style="font-weight: bold; color: #7a3db8;">It motivates us to look at distribution alignment methods that directly modify \( p_{\text{inf}} \).</span> 

          <section class="paper">
            <p class="lead">
              <strong>Rejection Sampling (RS).</strong> 
              <br> 
              Rejection Sampling (RS) allows us to directly use the policy distribution \( p_{\text{target}} \) to affect the rollout distribution \( p_{\text{inf}} \). 
              <details class="defn">
                <summary>
                  <span class="badge" style="color: #7a3db8;">Definition</span>
                  <span class="title" style="color: #7a3db8;">Rejection Sampling (RS)</span>
                  <span class="hint">(click to fold/unfold)</span>
                </summary>
              
                <div class="content">
                  <p>
                    RS stochastically rejects tokens in trajectories sampled with \(p_{\text{inf}}\) based on the difference
                    between two distributions. In standard rejection sampling, a token \(i\) proposed from \(\boldsymbol{q}\)
                    is accepted with probability
                    \( \frac{p_i}{\lambda q_i} \),
                    where the constant \(\lambda\) must satisfy
                    \( \lambda \ge \max_i \frac{p_i}{q_i} \).
                  </p>
              
                  <p>
                    Therefore, we have
                    \( \tilde{q}_i \propto q_i \cdot \frac{p_i}{\lambda q_i} \).
                    Then \( \tilde{q}_i = p_i \) after normalization. Therefore, rejection sampling transforms samples from
                    \(\boldsymbol{q}\) into exact samples from the target distribution \(\boldsymbol{p}\).
                  </p>
              
                  <div class="math-block">
                    \[
                      \text{Accept}(i) = \frac{p_i}{\lambda q_i},
                      \qquad
                      \lambda \ge \max_i \frac{p_i}{q_i}
                    \]
                    \[
                      \tilde{q}_i \propto q_i \cdot \frac{p_i}{\lambda q_i}
                      \;\Rightarrow\;
                      \tilde{q}_i \propto p_i
                      \;\Rightarrow\;
                      \tilde{q}_i = p_i \;(\text{normalized})
                    \]
                  </div>
                </div>
              </details> 
            </p> 
          </section>
          The problem of RS is that LLM output distribution is high dimensional, usually exceeding 30k tokens. Realistically, using naive RS will requires \( \lambda \) to be of high numerical values and effectively rejecting all tokens from rollouts. 
          <br> 
          Instead, we look at <span style="font-weight: bold; color: #7a3db8;">Optimal Budgeted Rejection Sampling</span> <a href="https://arxiv.org/abs/2311.00460" target="_blank" rel="noopener noreferrer" style="color: #7a3db8;">[OBRS]</a>. We stop aiming at forcing the rollout distribution post modification identical to the target distribution, and instead aim at given a budget of how many tokens we are willing to reject, how to most effectively select tokens to reject and minimize the KL divergence between the rollout distribution after modifcations and the target distribution. 
          <section class="paper">
            <p class="lead"> 
          <details class="defn" open>
            <summary>
              <span class="badge" style="color: #7a3db8;">Definition</span>
              <span class="title" style="color: #7a3db8;">Optimal Budget Rejection Sampling (OBRS)</span>
              <span class="hint">(click to fold/unfold)</span>
            </summary>
          
            <div class="content">
          
              <p>
                Instead of using the dominating constant
                \( \lambda = \max_i \tfrac{p_i}{q_i} \),
                OBRS selects a smaller user-specified parameter
                \( \lambda > 0 \)
                that reflects the desired rejection budget.
                For a proposed token \( i \sim \boldsymbol{q} \),
                OBRS accepts it with probability
              </p>
          
              <div class="math-block">
                \[
                  a_i = \min\!\left(1,\; \frac{p_i}{\lambda q_i}\right).
                \]
              </div>
          
              <p>
                The resulting post-rejection distribution is therefore
              </p>
          
              <div class="math-block">
                \[
                  \tilde{q}_i \propto q_i \cdot a_i .
                \]
              </div> 
          
            </div>
          </details> 
          </p> 
          </section> 
          Next, we will look at the numerical simulation of OBRS and show theoretical guarantees of OBRS. 
        </div>
      </div>
    </section> 

    <section id="method">
      <h2>KL-Divergence Reduction via Numerical Simulation and Theoretical Guarantees</h2> 
      <figure>
        <div style="display: inline-block; border-radius: 10px; border: 1px dashed #b9c2d3; background: linear-gradient(135deg, #f7f9fc 0%, #eef2f8 100%); padding: 8px;">
          <img src="assets/figures/numericalsim.png" alt="Numerical Simulation of OBRS" style="display: block; width: auto; height: auto; max-width: 100%; border-radius: 8px;" />
        </div>
      </figure> 
      We conducted numerical experiments in (a) and (b), where we simulate the LLMs' output distribution with randomly generated Dirichlet distribution with controllable noise to attain different levels of KL divergence. 
      (a) plots the simulated OBRS acceptance rate across different pairs of actor-policy distributions. 
      While overal trend sees acceptance rate slowly decreasing as the distributions move further apart, the acceptance rate remains high (\(>90\%\)) throughout the spectrum. 
      For reference, we also marks the actor-policy gap of different common seen off-policy settings. 
      In (b), we show that <span style="font-weight: bold; color: #7a3db8;">OBRS significantly shrinks the KL divergence</span> between the target distribution versus the applied distribution in our simulations, sometimes by an order of magnitude. 
      In (c), our proposed method, Jackpot (yellow) <span style="font-weight: bold; color: #7a3db8;">maintains small KL divergence</span> between actor and policy model probability distribution, while without alginment and TIS both seen KL divergence explosively rise up as the training continues. 
      <br>
      In addition to the numerical simulation, <span style="font-weight: bold; color: #7a3db8;">OBRS provides the following strong theoretical guarantees</span>. 
      <section class="paper">
        <p class="lead">
      <details class="thm" open>
        <summary>
          <span class="badge" style="color: #7a3db8;">Theorem</span>
          <span class="title" style="color: #7a3db8;">OBRS Improves Distribution Alignment (KL Divergence \( \downarrow \))</span> 
          <span class="hint">(click to fold/unfold)</span>
        </summary>
      
        <div class="content">
          <p>
            Let \( \boldsymbol{p} \) be the target distribution and \( \boldsymbol{q} \) be the proposal distribution.
            For any \( \lambda > 0 \), define the OBRS acceptance rule
          </p>
      
          <div class="math-block">
            \[
              a_i = \min\!\left(1, \frac{p_i}{\lambda q_i}\right),
              \qquad
              \tilde{q}_i \propto q_i a_i .
            \]
          </div>
      
          <p>
            Then the post-rejection distribution \( \tilde{\boldsymbol{q}} \) is strictly closer to \( \boldsymbol{p} \)
            than the original proposal \( \boldsymbol{q} \) in the sense that
          </p>
      
          <div class="math-block">
            \[
              D_{\mathrm{KL}}(\boldsymbol{p} \,\|\, \tilde{\boldsymbol{q}})
              \;\le\;
              D_{\mathrm{KL}}(\boldsymbol{p} \,\|\, \boldsymbol{q}),
            \]
            \[
              \text{whenever } \lambda < \max_i \frac{p_i}{q_i}.
            \]
          </div>
      
        </div>
      </details> 
      </p> 
      </section> 
      In other words, OBRS always moves the proposal distribution toward the target distribution under any nontrivial rejection budget. 
      <section class="paper">
        <p class="lead">
          <details class="thm" open>
            <summary>
              <span class="badge" style="color: #7a3db8;">Theorem</span>
              <span class="title" style="color: #7a3db8;">Optimality of OBRS under a Fixed Acceptance Budget</span> 
              <span class="hint">(click to fold/unfold)</span>
            </summary>
          
            <div class="content">
              <p>
                For any desired average acceptance rate \( \bar{a} \in (0,1] \), there exists a unique scaling factor
                \( \lambda > 0 \) such that the OBRS acceptance rule
              </p>
          
              <div class="math-block">
                \[
                  a_i = \min\!\left(1, \frac{p_i}{\lambda q_i}\right)
                \]
              </div>
          
              <p>
                achieves the exact acceptance budget:
              </p>
          
              <div class="math-block">
                \[
                  \sum_i q_i a_i = \bar{a}.
                \]
              </div>
          
              <p>
                Moreover, among all acceptance rules \( a_i \in [0,1] \) that satisfy this constraint, the OBRS rule is the
                unique minimizer of the divergence to the target distribution:
              </p>
          
              <div class="math-block">
                \[
                  \tilde{\boldsymbol{q}}
                  = \arg\min_{\hat{\boldsymbol{q}}}
                  D_{\mathrm{KL}}(\boldsymbol{p} \,\|\, \hat{\boldsymbol{q}}),
                  \quad \text{s.t.}\quad
                  \hat{q}_i \propto q_i a_i,\;
                  \sum_i q_i a_i = \bar{a}.
                \]
              </div>

            </div>
          </details> 
        </p>
      </section> 
      Thus, OBRS is provably optimal for aligning \( \boldsymbol{q} \) toward \( \boldsymbol{p} \) under any
      specified rejection budget. Detailed proofs are provided in the paper. 
    </section>

    <section id="theory">
      <h2>Jackpot</h2>
      <figure>
        <div style="display: inline-block; border-radius: 10px; border: 1px dashed #b9c2d3; background: linear-gradient(135deg, #f7f9fc 0%, #eef2f8 100%); padding: 8px;">
          <img src="assets/figures/methodjackpot.png" alt="Jackpot" style="display: block; width: auto; height: auto; max-width: 100%; border-radius: 8px;" />
        </div>
      </figure> 
      <p>
      <b>Jackpot</b> jointly optimizes three components:
      </p>
        
      <ul>
        <li><b>(i)</b> OBRS-adjusted RL loss for the policy model \( \theta \)</li>
        <li><b>(ii)</b> Standard PPO loss for the rollout model \( \omega \)</li>
        <li><b>(iii)</b> On-policy distillation to keep rollout aligned with policy</li>
        </ul>
        
        <p>Below we describe the policy objective.</p>
        
        
        <!-- ================= POLICY OBJECTIVE ================= -->
        
        <details class="theory" open>
        <summary><b>OBRS-Adjusted RL Loss for the Policy Model</b></summary>
        
        <div class="content">
        
        <p>
        Tokens are sampled from the rollout distribution \(p_{\text{inf}}\).
        Each token \(x\) is accepted via OBRS:
        </p>
        
        <div class="math-block">
        \[
        a(x)=
        \min\!\left(1,\frac{p_{\text{target}}(x)}{\lambda\,p_{\text{inf}}(x)}\right),
        \qquad
        \mathrm{Mask}(x)\sim\mathrm{Bernoulli}(a(x)).
        \]
        </div>
        
        <p>
        Accepted tokens define the adjusted sampling distribution
        </p>
        
        <div class="math-block">
        \[
        p'_{\text{inf}}(x)=
        \frac{p_{\text{inf}}(x)a(x)}
        {\sum_{x'} p_{\text{inf}}(x')a(x')}.
        \]
        </div>
        
        <p>
        The standard PPO objective
        </p>
        
        <div class="math-block">
        \[
        \mathcal{L}^{\text{PPO}}(\theta)=
        \mathbb{E}_{x\sim p_{\text{inf}}}
        \Big[
        \mathrm{SG}\!\left(
        \boldsymbol{F}\!\left(\tfrac{p_{\text{ref}}(x)}{p_{\text{inf}}(x)}\right)
        \right)
        \min\big(
        r_\theta(x)\hat{A}(x),
        \operatorname{clip}(r_\theta(x),1-\epsilon,1+\epsilon)\hat{A}(x)
        \big)
        \Big]
        \]
        </div>
        
        <p>
        becomes the OBRS-aware objective
        </p>
        
        <div class="math-block highlight">
        \[
        \mathcal{L}^{\text{PPO-OBRS}}(\theta)=
        \mathbb{E}_{x\sim p_{\text{inf}}}
        \Big[
        \mathrm{Mask}(x)\,
        \mathrm{SG}\!\left(
        \boldsymbol{F}\!\left(
        \frac{p_{\text{target}}(x)}{p'_{\text{inf}}(x)}
        \right)
        \frac{p_{\text{ref}}(x)}{p_{\text{target}}(x)}
        \right)
        \min\big(
        r_\theta(x)\hat{A}(x),
        \operatorname{clip}(r_\theta(x),1-\epsilon,1+\epsilon)\hat{A}(x)
        \big)
        \Big]
        \]
        </div>
        
        <p>
        Rejected samples are removed by \( \mathrm{Mask}(x) \), while accepted
        samples are reweighted through \( p'_{\text{inf}} \).
        The function \( \boldsymbol{F} \) provides truncated importance correction.
        The target distribution \(p_{\text{target}}\) may be chosen as either
        \(p_{\text{ref}}\) or the updated policy \(p_{\theta_{\text{new}}}\)
        for alignment.
        </p>
        
        </div>
        </details> 
    </section> 

    <section id="experiments">
      <h2>Experimental</h2>
      <figure>
        <div style="display: inline-block; border-radius: 10px; border: 1px dashed #b9c2d3; background: linear-gradient(135deg, #f7f9fc 0%, #eef2f8 100%); padding: 8px;">
          <img src="assets/figures/experiments.png" alt="Experiments" style="display: block; width: auto; height: auto; max-width: 100%; border-radius: 8px;" />
        </div>
      </figure> 
      <h3>Jackpot Enables Stable Training of One model Rollout and Another Completely Different Model Update</h3> 
      <p>
        Jackpot enables probability distribution alignment beyond existing methods.
        In the extreme two-model joint training setting, Jackpot allows the smaller,
        weaker model to roll out trajectories that are then used by the larger,
        stronger model for training.
        We show that prior TIS methods — even when augmented with KL regularization —
        consistently suffer from unstable training across three settings:
        Qwen2.5 (1.5B vs. 3B), Qwen3 (1.7B vs. 4B), and Qwen3 (1.7B vs. 8B) base models.
        In contrast, Jackpot achieves performance comparable to the large model’s
        on-policy performance. 
      </p> 
      <h3>Jackpot Can Enable Removal of Clipping in other actor-policy mismatch settings</h3> 
      <figure> 
        <div style="display: inline-block; border-radius: 10px; border: 1px dashed #b9c2d3; background: linear-gradient(135deg, #f7f9fc 0%, #eef2f8 100%); padding: 8px;">
          <img src="assets/figures/clippingexperiments.png" alt="Clipping Experiments" style="display: block; width: auto; height: auto; max-width: 100%; border-radius: 8px;" /> 
        </div>
      </figure> 
      <p> 
        (a) Jackpot enables removal of clipping in stale RL training.
        (b) Jackpot shows neither improvement nor degradation when actor–policy
        distributions are relatively close and can be sufficiently corrected by TIS.
        (c) When KL regularization is removed, Jackpot consistently sustains training
        longer than TIS counterparts.
      </p> 
      <span style="font-weight: bold; color: #7a3db8;">We present more details about the experiment setup, ablations, and results in the paper.</span> 
    </section>

    <section id="limitations">
      <h2>Limitations</h2>
      <p class="lede">
        Despite Jackpot's effectiveness, there are still important limitations and gaps from existing methods. 
        <br> 
        1. Moreover, although Jackpot reduces
        the mismatch between the rollout model and the policy model, using a fully
        separate, smaller actor model to train a large and expensive policy does
        not completely eliminate the distribution gap or the resulting training
        instability. In our experiments, training may still diverge after extended
        optimization (e.g., beyond 300 update steps). 
        <br> 
        2. As shown in Paper Section 6, when the distribution shift is already small or
        adequately controlled by existing techniques (e.g., TIS, PPO clipping, KL regularization, etc.), Jackpot yields only minor
        improvements over standard baselines. 
        <span style="font-weight: bold; color: #7a3db8;">We leave these as future work.</span> 
      </p> 
    </section> 

    <section id="citeus">
      <h2>References</h2> 
      If you find Jackpot useful, please cite: 
      <div class="container is-max-desktop content">
        <h2 class="title">BibTeX</h2>
        <pre><code>@misc{jackpot2025github,
title        = {Jackpot: Optimal Budgeted Rejection Sampling for Extreme Actor-Policy Mismatch RL},
author       = {Liu, Hongyi and Chen, Zhuoming and Zhou, Yang and Zheng, Haizhong and Chen, Beidi},
howpublished = {\url{https://github.com/Infini-AI-Lab/jackpot.git}},
note         = {Official GitHub repository},
year         = {2025}
}</code></pre>
      </div>
    </div>
      <img
        src="assets/figures/GSMQQ.gif" 
        width="200"
        height="200" 
        style="display: block;margin: auto"/>
    </div> 
    </section> 

    <footer class="footer">
      <p><a href="#top">Back to top</a></p>
    </footer>
  </div>
</body>
</html> 
